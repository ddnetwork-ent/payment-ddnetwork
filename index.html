<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Select Package - DDNetwork One</title>
    <style>
        /* --- CSS Variables & Reset --- */
        :root {
            --primary: #2563eb;
            --primary-light: #eff6ff;
            --text-dark: #1e293b;
            --text-gray: #64748b;
            --bg-body: #f8fafc;
            --bg-card: #ffffff;
            --border: #e2e8f0;
            --success: #10b981;
            --whatsapp-green: #25D366;
            --warning: #f59e0b;
            --danger: #ef4444;
            --radius: 12px;
            --shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.05);
        }

        * { box-sizing: border-box; margin: 0; padding: 0; font-family: 'Inter', sans-serif; }

        body { background-color: var(--bg-body); color: var(--text-dark); line-height: 1.6; display: flex; flex-direction: column; min-height: 100vh; }

        /* --- Header (Logo Left, Text Right) --- */
        header { background: var(--bg-card); border-bottom: 1px solid var(--border); padding: 15px 20px; position: sticky; top: 0; z-index: 100; box-shadow: 0 2px 4px rgba(0,0,0,0.02); }
        
        .container { max-width: 1200px; margin: 0 auto; padding: 0 20px; }
        
        .brand-header {
            display: flex;
            align-items: center;
            justify-content: center; /* Center the whole header block */
            font-weight: 700;
            font-size: 1.5rem;
            color: var(--text-dark);
        }

        /* Logo Left, Text Right */
        .logo-flex {
            display: flex;
            align-items: center;
            gap: 12px;
            text-decoration: none;
            color: inherit;
        }
        
        .logo-img {
            height: 45px; /* Control height of the logo */
            width: auto;
            object-fit: contain;
        }

        .brand-text {
            color: var(--text-dark);
            letter-spacing: -0.5px;
        }

        /* --- Main Layout & Steps --- */
        main { flex: 1; padding: 40px 0; }
        
        /* Step Containers */
        .step-container { display: none; animation: fadeIn 0.4s ease-out; }
        .step-container.active { display: block; }

        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        /* --- Step 1: Packages --- */
        .packages-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 30px; max-width: 1000px; margin: 0 auto; }

        .package-card {
            background: var(--bg-card); border: 2px solid var(--border); border-radius: var(--radius);
            padding: 30px; cursor: pointer; transition: all 0.3s ease; position: relative; display: flex; flex-direction: column; text-align: left;
        }
        .package-card:hover { border-color: var(--primary); transform: translateY(-5px); box-shadow: var(--shadow); }
        
        .badge { position: absolute; top: 15px; right: 15px; font-size: 0.7rem; font-weight: 700; padding: 4px 10px; border-radius: 20px; text-transform: uppercase; }
        .badge.popular { background: var(--primary); color: white; }
        .badge.value { background: var(--success); color: white; }

        .pkg-price { font-size: 2rem; font-weight: 800; margin: 20px 0; color: var(--text-dark); }
        .pkg-price span { font-size: 1rem; color: var(--text-gray); font-weight: 400; }
        
        .pkg-features { list-style: none; margin: 20px 0 30px 0; flex: 1; }
        .pkg-features li { font-size: 0.95rem; color: var(--text-gray); margin-bottom: 10px; padding-left: 25px; position: relative; }
        .pkg-features li::before { content: "✓"; position: absolute; left: 0; color: var(--success); font-weight: bold; }

        .select-btn { background: var(--primary); color: white; border: none; padding: 15px; border-radius: 8px; font-size: 1rem; font-weight: 600; width: 100%; cursor: pointer; transition: 0.2s; }
        .select-btn:hover { background: #1d4ed8; }

        /* --- Step 2: Order Form --- */
        .step-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 30px; }
        .back-btn { background: transparent; border: 1px solid var(--border); color: var(--text-gray); padding: 8px 16px; border-radius: 6px; cursor: pointer; display: flex; align-items: center; gap: 8px; font-size: 0.9rem; transition: 0.2s; }
        .back-btn:hover { background: var(--bg-body); color: var(--text-dark); }

        .step-2-grid { display: grid; grid-template-columns: 1.2fr 0.8fr; gap: 40px; }
        
        /* Left Column: Forms & Addons */
        .form-section { background: var(--bg-card); border: 1px solid var(--border); border-radius: var(--radius); padding: 30px; margin-bottom: 30px; }
        .section-title { font-size: 1.2rem; margin-bottom: 20px; color: var(--text-dark); font-weight: 700; border-bottom: 1px solid var(--border); padding-bottom: 10px; }

        .form-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 10px; }
        .form-group { margin-bottom: 15px; }
        .form-group.full { grid-column: 1 / -1; }
        
        .form-label { display: block; font-size: 0.85rem; font-weight: 600; color: var(--text-gray); margin-bottom: 6px; }
        .form-input { width: 100%; padding: 12px; border: 1px solid var(--border); border-radius: 6px; font-size: 0.95rem; outline: none; transition: 0.2s; }
        .form-input:focus { border-color: var(--primary); box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.1); }
        .form-input.error { border-color: var(--danger); background-color: #fef2f2; }

        /* Addons */
        .addon-options { display: grid; grid-template-columns: 1fr; gap: 10px; }
        .radio-card { border: 1px solid var(--border); padding: 15px; border-radius: 8px; cursor: pointer; display: flex; justify-content: space-between; align-items: center; transition: 0.2s; }
        .radio-card:hover { border-color: #94a3b8; }
        .radio-card.active { border-color: var(--primary); background-color: var(--primary-light); }

        /* Right Column: Summary */
        .summary-sidebar { background: var(--bg-card); border: 1px solid var(--border); border-radius: var(--radius); padding: 30px; height: fit-content; position: sticky; top: 100px; }
        
        .summary-row { display: flex; justify-content: space-between; margin-bottom: 15px; font-size: 0.95rem; color: var(--text-gray); }
        .summary-row.total { margin-top: 25px; padding-top: 20px; border-top: 2px dashed var(--border); font-weight: 800; font-size: 1.3rem; color: var(--text-dark); }

        .selected-package-box {
            background: var(--primary-light); border: 1px solid var(--primary); padding: 15px; border-radius: 8px; margin-bottom: 25px;
        }
        .selected-pkg-name { font-weight: 700; color: var(--primary); font-size: 1.1rem; }

        /* Custom Budget */
        .custom-budget-group { background: #f1f5f9; padding: 15px; border-radius: 8px; border: 1px solid var(--border); margin-bottom: 20px; transition: 0.3s; }
        .custom-budget-group.unlocked { background: #fffbeb; border-color: var(--warning); }
        .budget-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px; }
        .custom-label { font-size: 0.85rem; font-weight: 600; color: var(--text-gray); }
        .custom-input { width: 100%; padding: 10px; border: 1px solid var(--border); border-radius: 6px; font-size: 1.1rem; font-weight: 700; color: var(--text-dark); outline: none; transition: 0.2s; }
        .custom-input:focus { border-color: var(--primary); }
        .range-display { font-size: 0.8rem; color: var(--text-gray); margin-top: 5px; }
        .unlock-btn { font-size: 0.75rem; color: var(--primary); background: white; border: 1px solid var(--primary); padding: 4px 8px; border-radius: 4px; cursor: pointer; }
        
        /* Payment Buttons */
        .btn-tng { display: flex; align-items: center; justify-content: center; gap: 10px; background: white; color: #2563eb; border: 2px solid #2563eb; padding: 15px; width: 100%; border-radius: 8px; font-size: 1rem; font-weight: 700; cursor: pointer; text-decoration: none; transition: 0.2s; margin-top: 25px; }
        .btn-tng:hover { background: #2563eb; color: white; }
        
        .btn-pay { display: flex; align-items: center; justify-content: center; gap: 10px; background: var(--whatsapp-green); color: white; border: none; padding: 16px; width: 100%; border-radius: 8px; font-size: 1.1rem; font-weight: 700; cursor: pointer; margin-top: 15px; transition: background 0.2s; }
        .btn-pay:hover { background: #20bd5a; }

        /* Modal */
        .modal-overlay { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(255, 255, 255, 0.9); backdrop-filter: blur(5px); z-index: 2000; align-items: center; justify-content: center; animation: fadeIn 0.3s; }
        .modal-content { background: white; padding: 40px; border-radius: 20px; text-align: center; border: 1px solid var(--border); max-width: 400px; width: 90%; box-shadow: 0 20px 25px -5px rgba(0,0,0,0.1); }
        .success-icon { width: 80px; height: 80px; background: #dcfce7; color: #16a34a; border-radius: 50%; display: flex; align-items: center; justify-content: center; margin: 0 auto 20px auto; }
        .spinner { border: 4px solid #f3f3f3; border-top: 4px solid var(--primary); border-radius: 50%; width: 30px; height: 30px; animation: spin 1s linear infinite; margin: 0 auto; }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }

        @media (max-width: 900px) { 
            .step-2-grid { grid-template-columns: 1fr; } 
            .summary-sidebar { position: relative; top: 0; }
            .form-grid { grid-template-columns: 1fr; }
        }
    </style>
</head>
<body>

    <!-- Header -->
    <header>
        <div class="container">
            <div class="brand-header">
                <!-- Logo Left, Text Right -->
                <div class="logo-flex">
                    <!-- Updated Logo Image -->
                    <img src="https://raw.githubusercontent.com/ddnetwork-ent/DDN-One/refs/heads/main/DD-LOGO.JPEG" alt="DDNetwork Logo" class="logo-img">
                    <span class="brand-text">DDNetwork One</span>
                </div>
            </div>
        </div>
    </header>

    <main class="container">
        
        <!-- STEP 1: PACKAGE SELECTION -->
        <div id="step-1" class="step-container active">
            <div style="text-align: center; margin-bottom: 40px;">
                <h1 style="font-size: 2.5rem; margin-bottom: 10px; color: var(--text-dark);">Step 1: Choose Your Plan</h1>
                <p style="color: var(--text-gray); font-size: 1.1rem;">Select a core package to get started.</p>
            </div>

            <div class="packages-grid">
                <!-- Package 1 -->
                <div class="package-card" onclick="selectPackage(1, 200, 400, 'HTML Only (Static)')">
                    <h3>HTML Only (Static)</h3>
                    <div class="pkg-price">RM 200 <span>- 400</span></div>
                    <ul class="pkg-features">
                        <li>1–2 pages</li>
                        <li>Simple & clean layout</li>
                        <li>Mobile-friendly design</li>
                        <li>Basic SEO setup</li>
                        <li>Deployment guidance</li>
                    </ul>
                    <button class="select-btn">Select Package</button>
                </div>

                <!-- Package 2 -->
                <div class="package-card" onclick="selectPackage(2, 400, 800, 'Front-End Website')">
                    <span class="badge popular">Popular</span>
                    <h3>Front-End Website</h3>
                    <div class="pkg-price">RM 400 <span>- 800</span></div>
                    <ul class="pkg-features">
                        <li>HTML, CSS & JavaScript</li>
                        <li>Multi-page website</li>
                        <li>Fully responsive</li>
                        <li>Contact form (email)</li>
                        <li>1–2 rounds of revisions</li>
                    </ul>
                    <button class="select-btn">Select Package</button>
                </div>

                <!-- Package 3 -->
                <div class="package-card" onclick="selectPackage(3, 800, 1500, 'AI Powered Website')">
                    <span class="badge value">Best Value</span>
                    <h3>AI Powered Website</h3>
                    <div class="pkg-price">RM 800 <span>- 1,500</span></div>
                    <ul class="pkg-features">
                        <li>Everything in Front-End</li>
                        <li>AI chatbot setup</li>
                        <li>Lead capture & smart forms</li>
                        <li>Rule-based or API-based AI</li>
                        <li>14–30 days support</li>
                    </ul>
                    <button class="select-btn">Select Package</button>
                </div>
            </div>
        </div>

        <!-- STEP 2: ORDER DETAILS -->
        <div id="step-2" class="step-container">
            <div class="step-header">
                <h1 style="font-size: 2rem; color: var(--text-dark);">Step 2: Your Order</h1>
                <button class="back-btn" onclick="goToStep1()">
                    <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M19 12H5M12 19l-7-7 7-7"/>
                    </svg>
                    Change Plan
                </button>
            </div>

            <div class="step-2-grid">
                
                <!-- Left Column: Forms -->
                <div>
                    <!-- Customer Details Form -->
                    <div class="form-section">
                        <div class="section-title">Customer Details</div>
                        <div class="form-grid">
                            <div class="form-group full">
                                <label class="form-label">Full Name *</label>
                                <input type="text" id="cust-name" class="form-input" placeholder="e.g. Ahmad Ali">
                            </div>
                            <div class="form-group full">
                                <label class="form-label">Business / Website Name</label>
                                <input type="text" id="cust-biz" class="form-input" placeholder="e.g. Ali's Kedai Kopi">
                            </div>
                            <div class="form-group">
                                <label class="form-label">Email Address *</label>
                                <input type="email" id="cust-email" class="form-input" placeholder="email@example.com">
                            </div>
                            <div class="form-group">
                                <label class="form-label">WhatsApp Number</label>
                                <input type="tel" id="cust-phone" class="form-input" placeholder="0123456789">
                            </div>
                        </div>
                    </div>

                    <!-- Addons -->
                    <div class="form-section">
                        <div class="section-title">Enhance Your Package</div>
                        
                        <label class="form-label" style="margin-bottom:10px">Add-on: Domain Options</label>
                        <div class="addon-options" style="margin-bottom: 25px;">
                            <div class="radio-card active" id="domain_none" onclick="selectDomain('none', 0, 'No Domain')">
                                <span>No Domain</span>
                                <span style="font-weight:700">RM 0</span>
                            </div>
                            <div class="radio-card" id="domain_sub" onclick="selectDomain('sub', 55, 'DDNetwork Subdomain')">
                                <div>
                                    <span style="display:block; font-weight:600">DDNetwork Subdomain</span>
                                    <span style="font-size:0.8rem; color:var(--text-gray)">example.ddn.one</span>
                                </div>
                                <span style="font-weight:700">RM 55</span>
                            </div>
                            <div class="radio-card" id="domain_custom" onclick="selectDomain('custom', 0, 'Custom Domain')">
                                <span>Custom Domain</span>
                                <span style="font-size:0.85rem; color:var(--text-gray)">Based on Provider</span>
                            </div>
                        </div>

                        <label class="form-label" style="margin-bottom:10px">Add-on: Monthly Maintenance</label>
                        <div class="addon-options">
                            <div class="radio-card active" id="maint_none" onclick="selectMaintenance('none', 0, 'No Maintenance')">
                                <span>No Maintenance</span>
                                <span style="font-weight:700">RM 0</span>
                            </div>
                            <div class="radio-card" id="maint_basic" onclick="selectMaintenance('basic', 50, 'Basic Care')">
                                <div>
                                    <span style="display:block; font-weight:600">Basic Care</span>
                                    <span style="font-size:0.8rem; color:var(--text-gray)">Content updates & basic checks</span>
                                </div>
                                <span style="font-weight:700">RM 50</span>
                            </div>
                            <div class="radio-card" id="maint_business" onclick="selectMaintenance('business', 100, 'Business Care')">
                                <div>
                                    <span style="display:block; font-weight:600">Business Care</span>
                                    <span style="font-size:0.8rem; color:var(--text-gray)">Content updates, backup & SEO</span>
                                </div>
                                <span style="font-weight:700">RM 100</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Right Column: Summary -->
                <aside>
                    <div class="summary-sidebar">
                        <div class="section-title">Order Summary</div>
                        
                        <!-- Selected Package Display -->
                        <div class="selected-package-box">
                            <div style="font-size:0.8rem; color:var(--text-gray); text-transform:uppercase; margin-bottom:4px;">Selected Package</div>
                            <div class="selected-pkg-name" id="summary-pkg-name">Front-End Website</div>
                            <div style="margin-top:5px; font-size:0.9rem; color:var(--text-gray);" id="summary-pkg-range">RM 400 - RM 800</div>
                        </div>

                        <div id="summary-items">
                            <!-- JS Populates addons here -->
                        </div>

                        <!-- Custom Budget -->
                        <div class="custom-budget-group" id="budget-group">
                            <div class="budget-header">
                                <span class="custom-label">Your Price / Budget</span>
                                <button type="button" class="unlock-btn" id="unlock-btn" onclick="toggleBudgetLock()">Set to own budget</button>
                            </div>
                            <input type="number" id="custom-price-input" class="custom-input" placeholder="Auto" oninput="handleCustomPrice()">
                            <div class="range-display" id="range-text">Allowed: RM 400 - RM 800</div>
                        </div>

                        <div class="summary-row total">
                            <span>Total Amount</span>
                            <span id="final-total">RM 400</span>
                        </div>

                        <!-- Step 1: Pay -->
                        <a href="https://payment.tngdigital.com.my/sc/bDLob7YcpG" target="_blank" class="btn-tng">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor"><path d="M20 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 4l-8 5-8-5V6l8 5 8-5v2z"/></svg>
                            Pay via TNG eWallet
                        </a>

                        <!-- Step 2: WhatsApp -->
                        <button class="btn-pay" onclick="sendWhatsApp()">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="white"><path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413z"/></svg>
                            Send Order & Payment Proof
                        </button>
                        <p style="text-align:center; margin-top:10px; font-size:0.8rem; color:var(--text-gray)">After payment, click button above.</p>
                    </div>
                </aside>
            </div>
        </div>

    </main>

    <!-- Modal -->
    <div id="thankYouModal" class="modal-overlay">
        <div class="modal-content">
            <div class="success-icon">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path><polyline points="22 4 12 14.01 9 11.01"></polyline></svg>
            </div>
            <h2>Thank You!</h2>
            <p>We are preparing your order details on WhatsApp...</p>
            <div class="spinner"></div>
        </div>
    </div>

    <script>
        // State
        let currentPackage = { id: 2, name: 'Front-End Website', price: 400, min: 400, max: 800 };
        let currentDomain = { id: 'none', name: 'No Domain', price: 0 };
        let currentMaintenance = { id: 'none', name: 'No Maintenance', price: 0 };
        let isBudgetUnlocked = false;

        // --- Navigation Functions ---
        function selectPackage(id, price, maxPrice, name) {
            // Save package
            currentPackage = { id, name, price, min: price, max: maxPrice };
            
            // Reset Addons for fresh selection
            resetAddons();
            
            // Update Step 2 UI based on selection
            document.getElementById('summary-pkg-name').textContent = name;
            document.getElementById('summary-pkg-range').textContent = `RM ${price} - RM ${maxPrice}`;
            
            // Transition to Step 2
            document.getElementById('step-1').classList.remove('active');
            document.getElementById('step-2').classList.add('active');
            
            // Scroll to top
            window.scrollTo(0, 0);
            
            updateUI();
        }

        function goToStep1() {
            document.getElementById('step-2').classList.remove('active');
            document.getElementById('step-1').classList.add('active');
        }

        function resetAddons() {
            currentDomain = { id: 'none', name: 'No Domain', price: 0 };
            currentMaintenance = { id: 'none', name: 'No Maintenance', price: 0 };
            isBudgetUnlocked = false;
            document.getElementById('budget-group').classList.remove('unlocked');
            document.getElementById('unlock-btn').textContent = "Set to own budget";
            document.getElementById('custom-price-input').value = '';
            
            // Reset Visuals
            document.querySelectorAll('.radio-card').forEach(el => el.classList.remove('active'));
            document.getElementById('domain_none').classList.add('active');
            document.getElementById('maint_none').classList.add('active');
        }

        // --- Logic Functions ---
        function selectDomain(id, price, name) {
            currentDomain = { id, name, price };
            document.querySelectorAll('[id^="domain_"]').forEach(el => el.classList.remove('active'));
            document.getElementById('domain_' + id).classList.add('active');
            updateSummaryUI();
        }

        function selectMaintenance(id, price, name) {
            currentMaintenance = { id, name, price };
            document.querySelectorAll('[id^="maint_"]').forEach(el => el.classList.remove('active'));
            document.getElementById('maint_' + id).classList.add('active');
            updateSummaryUI();
        }

        function updateUI() {
            updateSummaryUI();
            updateRangeDisplay();
        }

        function updateSummaryUI() {
            const container = document.getElementById('summary-items');
            let html = '';

            if (currentDomain.price > 0) {
                html += `<div class="summary-row"><span>${currentDomain.name}</span><span>RM ${currentDomain.price}</span></div>`;
            }
            if (currentMaintenance.price > 0) {
                html += `<div class="summary-row"><span>${currentMaintenance.name}</span><span>RM ${currentMaintenance.price}</span></div>`;
            }
            container.innerHTML = html;
            updateTotalDisplay();
        }

        function toggleBudgetLock() {
            isBudgetUnlocked = !isBudgetUnlocked;
            const group = document.getElementById('budget-group');
            const btn = document.getElementById('unlock-btn');

            if (isBudgetUnlocked) {
                group.classList.add('unlocked');
                btn.textContent = "Lock to Package Range";
            } else {
                group.classList.remove('unlocked');
                btn.textContent = "Set to own budget";
                handleCustomPrice(); // Clamp logic
            }
            updateRangeDisplay();
        }

        function updateRangeDisplay() {
            const rangeText = document.getElementById('range-text');
            if (isBudgetUnlocked) {
                rangeText.textContent = "Custom budget active (Any amount)";
                rangeText.style.color = "#d97706";
            } else {
                rangeText.textContent = `Allowed: RM ${currentPackage.min} - RM ${currentPackage.max}`;
                rangeText.style.color = "var(--text-gray)";
            }
        }

        function handleCustomPrice() {
            const input = document.getElementById('custom-price-input');
            let val = parseFloat(input.value);
            
            if (!isNaN(val)) {
                if (!isBudgetUnlocked) {
                    if (val < currentPackage.min) {
                        input.value = currentPackage.min;
                        val = currentPackage.min;
                    } else if (val > currentPackage.max) {
                        input.value = currentPackage.max;
                        val = currentPackage.max;
                    }
                }
                updateTotalDisplay(val);
            } else {
                updateTotalDisplay();
            }
        }

        function updateTotalDisplay(customVal = null) {
            const totalEl = document.getElementById('final-total');
            
            if (customVal !== null) {
                totalEl.textContent = `RM ${customVal}`;
                totalEl.style.color = 'var(--primary)';
            } else {
                const baseTotal = currentPackage.price + currentDomain.price + currentMaintenance.price;
                totalEl.textContent = `RM ${baseTotal}`;
                totalEl.style.color = 'var(--text-dark)';
            }
        }

        function sendWhatsApp() {
            const nameInput = document.getElementById('cust-name');
            const emailInput = document.getElementById('cust-email');
            let isValid = true;

            if(!nameInput.value.trim()) { nameInput.classList.add('error'); isValid = false; } else { nameInput.classList.remove('error'); }
            if(!emailInput.value.trim()) { emailInput.classList.add('error'); isValid = false; } else { emailInput.classList.remove('error'); }

            if(!isValid) { alert("Please fill in Name and Email."); return; }

            const modal = document.getElementById('thankYouModal');
            modal.style.display = 'flex';
            
            const phoneNumber = "60122600969";
            const custName = document.getElementById('cust-name').value;
            const custBiz = document.getElementById('cust-biz').value || "N/A";
            const custEmail = document.getElementById('cust-email').value;
            const custPhone = document.getElementById('cust-phone').value || "N/A";

            const inputVal = document.getElementById('custom-price-input').value;
            let finalPrice = inputVal ? parseFloat(inputVal).toFixed(0) : (currentPackage.price + currentDomain.price + currentMaintenance.price);

            const message = `*NEW WEBSITE ORDER - DDNetwork One* %0a%0a` +
                            `*Customer Details:* %0aName: ${custName} %0aBusiness: ${custBiz} %0aEmail: ${custEmail} %0aPhone: ${custPhone} %0a%0a` +
                            `*Order Details:* %0aPackage: ${currentPackage.name} %0aDomain: ${currentDomain.name} %0aMaintenance: ${currentMaintenance.name} %0a%0a` +
                            `*Total Amount:* RM ${finalPrice} %0a%0a` +
                            `Hi, I have paid RM ${finalPrice} via TNG eWallet. Please find attached payment proof/receipt.`;

            setTimeout(() => {
                window.open(`https://wa.me/${phoneNumber}?text=${message}`, '_blank');
                modal.style.display = 'none';
            }, 1500);
        }

        // Init
        updateUI();

    </script>
</body>
</html>
